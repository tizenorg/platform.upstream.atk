From: Patryk Kaczmarek <patryk.k@samsung.com>
Date: Mon, 27 Apr 2015 15:11:03 +0200
Subject: Tizen 2.4 spin repo configuration

Change-Id: I4f21d433d0489c539ac33b33334e3d940dc83479
Signed-off-by: Patryk Kaczmarek <patryk.k@samsung.com>

Conflicts:
	packaging/atk.spec
---
 Makefile.am         |  5 ++-
 atk/Makefile.am     | 29 -----------------
 autogen.sh          | 35 +++++++++++++++-----
 configure.ac        |  7 ++--
 m4/introspection.m4 | 94 -----------------------------------------------------
 5 files changed, 30 insertions(+), 140 deletions(-)
 delete mode 100644 m4/introspection.m4

diff --git a/Makefile.am b/Makefile.am
index 6c5fe01..608dc7d 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -1,7 +1,7 @@
 # Process this file with automake to create Makefile.in.
 ACLOCAL_AMFLAGS = -I m4 ${ACLOCAL_FLAGS}
 
-SUBDIRS=atk tests docs po build
+SUBDIRS=atk tests docs build
 
 EXTRA_DIST = 			\
 	MAINTAINERS		\
@@ -10,13 +10,12 @@ EXTRA_DIST = 			\
 	atk.spec.in		\
 	atk.spec		\
 	atk-zip.sh.in   \
-    m4/introspection.m4   \
 	config.h.win32
 
 pkgconfigdir = $(libdir)/pkgconfig
 pkgconfig_DATA = atk.pc
 
-DISTCHECK_CONFIGURE_FLAGS = --enable-gtk-doc --enable-introspection
+DISTCHECK_CONFIGURE_FLAGS =
 
 DISTCLEANFILES =		\
 	atk-uninstalled.pc	\
diff --git a/atk/Makefile.am b/atk/Makefile.am
index c049470..c7152df 100644
--- a/atk/Makefile.am
+++ b/atk/Makefile.am
@@ -158,35 +158,6 @@ s-enum-types-c: @REBUILD@ $(atk_headers) Makefile
 	&& rm -f tmp-atk-enum-types.c \
 	&& echo timestamp > $(@F)
 
-
-if HAVE_INTROSPECTION
-introspection_sources = \
-    $(atk_headers)	\
-    $(atk_sources)
-introspection_generated_sources = \
-    $(top_builddir)/atk/atkversion.h 	\
-    atk-enum-types.c	\
-    atk-enum-types.h
-
-Atk-1.0.gir: libatk-1.0.la Makefile
-Atk_1_0_gir_INCLUDES = GObject-2.0
-Atk_1_0_gir_CFLAGS = $(AM_CPPFLAGS)
-Atk_1_0_gir_LIBS = libatk-1.0.la
-Atk_1_0_gir_SCANNERFLAGS = --pkg-export atk --warn-all --c-include "atk/atk.h"
-Atk_1_0_gir_FILES = \
-    $(addprefix $(srcdir)/, $(introspection_sources))	\
-    $(introspection_generated_sources)
-INTROSPECTION_GIRS += Atk-1.0.gir
-
-girdir = $(datadir)/gir-1.0
-gir_DATA = $(INTROSPECTION_GIRS)
-
-typelibsdir = $(libdir)/girepository-1.0
-typelibs_DATA = $(INTROSPECTION_GIRS:.gir=.typelib)
-
-CLEANFILES += $(gir_DATA) $(typelibs_DATA)
-endif
-
 # ---------- Win32 stuff ----------
 
 if OS_WIN32
diff --git a/autogen.sh b/autogen.sh
index 615d8d8..a36eba3 100755
--- a/autogen.sh
+++ b/autogen.sh
@@ -1,15 +1,32 @@
 #!/bin/sh
 # Run this to generate all the initial makefiles, etc.
 
-srcdir=`dirname $0`
-test -z "$srcdir" && srcdir=.
+test -n "$srcdir" || srcdir=`dirname "$0"`
+test -n "$srcdir" || srcdir=.
 
-PKG_NAME="atk"
-REQUIRED_AUTOMAKE_VERSION=1.7
+olddir=`pwd`
+cd "$srcdir"
 
-which gnome-autogen.sh || {
-    echo "You need to install gnome-common from the GNOME CVS"
-    exit 1
-}
+if test -z $GTKDOCIZE; then
+        echo "You don't have gtk-doc installed, and thus won't be able to generate the documentation."
+        rm -f gtk-doc.make
+        cat > gtk-doc.make <<EOF
+EXTRA_DIST =
+CLEANFILES =
+EOF
+else
+        gtkdocize || exit $?
+fi
 
-USE_GNOME2_MACROS=1 . gnome-autogen.sh
+AUTORECONF=`which autoreconf`
+if test -z $AUTORECONF; then
+        echo "*** No autoreconf found, please install it ***"
+        exit 1
+fi
+
+# gnome-autogen.sh runs configure, so do likewise.
+autoreconf --verbose --force --install -Wno-portability || exit 1
+
+cd "$olddir"
+
+test -n "$NOCONFIGURE" || "$srcdir/configure" "$@"
diff --git a/configure.ac b/configure.ac
index fe8b2fa..8ec04bd 100644
--- a/configure.ac
+++ b/configure.ac
@@ -195,10 +195,10 @@ ALL_LINGUAS="`grep -v '^#' "$srcdir/po/LINGUAS" | tr '\n' ' '`"
 AM_GLIB_GNU_GETTEXT
 
 # Introspection support
-GOBJECT_INTROSPECTION_CHECK([0.6.7])
+#GOBJECT_INTROSPECTION_CHECK([0.6.7])
 
 # Documentation support
-GTK_DOC_CHECK([1.13])
+#GTK_DOC_CHECK([1.13])
 
 # define a MAINT-like variable REBUILD which is set if Perl
 # and awk are found, so autogenerated sources can be rebuilt
@@ -229,11 +229,8 @@ if test x"$PYTHON" = xyes; then
 fi
 AM_PATH_PYTHON(2.5,,PYTHON="/usr/bin/env python2.5")
 
-GNOME_COMPILE_WARNINGS([maximum])
-
 AC_CONFIG_FILES([
 Makefile
-po/Makefile.in
 atk.pc
 atk-uninstalled.pc
 atk/Makefile
diff --git a/m4/introspection.m4 b/m4/introspection.m4
deleted file mode 100644
index 589721c..0000000
--- a/m4/introspection.m4
+++ /dev/null
@@ -1,94 +0,0 @@
-dnl -*- mode: autoconf -*-
-dnl Copyright 2009 Johan Dahlin
-dnl
-dnl This file is free software; the author(s) gives unlimited
-dnl permission to copy and/or distribute it, with or without
-dnl modifications, as long as this notice is preserved.
-dnl
-
-# serial 1
-
-m4_define([_GOBJECT_INTROSPECTION_CHECK_INTERNAL],
-[
-    AC_BEFORE([AC_PROG_LIBTOOL],[$0])dnl setup libtool first
-    AC_BEFORE([AM_PROG_LIBTOOL],[$0])dnl setup libtool first
-    AC_BEFORE([LT_INIT],[$0])dnl setup libtool first
-
-    dnl enable/disable introspection
-    m4_if([$2], [require],
-    [dnl
-        enable_introspection=yes
-    ],[dnl
-        AC_ARG_ENABLE(introspection,
-                  AS_HELP_STRING([--enable-introspection[=@<:@no/auto/yes@:>@]],
-                                 [Enable introspection for this build]),, 
-                                 [enable_introspection=auto])
-    ])dnl
-
-    AC_MSG_CHECKING([for gobject-introspection])
-
-    dnl presence/version checking
-    AS_CASE([$enable_introspection],
-    [no], [dnl
-        found_introspection="no (disabled, use --enable-introspection to enable)"
-    ],dnl
-    [yes],[dnl
-        PKG_CHECK_EXISTS([gobject-introspection-1.0],,
-                         AC_MSG_ERROR([gobject-introspection-1.0 is not installed]))
-        PKG_CHECK_EXISTS([gobject-introspection-1.0 >= $1],
-                         found_introspection=yes,
-                         AC_MSG_ERROR([You need to have gobject-introspection >= $1 installed to build AC_PACKAGE_NAME]))
-    ],dnl
-    [auto],[dnl
-        PKG_CHECK_EXISTS([gobject-introspection-1.0 >= $1], found_introspection=yes, found_introspection=no)
-    ],dnl
-    [dnl	
-        AC_MSG_ERROR([invalid argument passed to --enable-introspection, should be one of @<:@no/auto/yes@:>@])
-    ])dnl
-
-    AC_MSG_RESULT([$found_introspection])
-
-    INTROSPECTION_SCANNER=
-    INTROSPECTION_COMPILER=
-    INTROSPECTION_GENERATE=
-    INTROSPECTION_GIRDIR=
-    INTROSPECTION_TYPELIBDIR=
-    if test "x$found_introspection" = "xyes"; then
-       INTROSPECTION_SCANNER=`$PKG_CONFIG --variable=g_ir_scanner gobject-introspection-1.0`
-       INTROSPECTION_COMPILER=`$PKG_CONFIG --variable=g_ir_compiler gobject-introspection-1.0`
-       INTROSPECTION_GENERATE=`$PKG_CONFIG --variable=g_ir_generate gobject-introspection-1.0`
-       INTROSPECTION_GIRDIR=`$PKG_CONFIG --variable=girdir gobject-introspection-1.0`
-       INTROSPECTION_TYPELIBDIR="$($PKG_CONFIG --variable=typelibdir gobject-introspection-1.0)"
-       INTROSPECTION_CFLAGS=`$PKG_CONFIG --cflags gobject-introspection-1.0`
-       INTROSPECTION_LIBS=`$PKG_CONFIG --libs gobject-introspection-1.0`
-       INTROSPECTION_MAKEFILE=`$PKG_CONFIG --variable=datadir gobject-introspection-1.0`/gobject-introspection-1.0/Makefile.introspection
-    fi
-    AC_SUBST(INTROSPECTION_SCANNER)
-    AC_SUBST(INTROSPECTION_COMPILER)
-    AC_SUBST(INTROSPECTION_GENERATE)
-    AC_SUBST(INTROSPECTION_GIRDIR)
-    AC_SUBST(INTROSPECTION_TYPELIBDIR)
-    AC_SUBST(INTROSPECTION_CFLAGS)
-    AC_SUBST(INTROSPECTION_LIBS)
-    AC_SUBST(INTROSPECTION_MAKEFILE)
-
-    AM_CONDITIONAL(HAVE_INTROSPECTION, test "x$found_introspection" = "xyes")
-])
-
-
-dnl Usage:
-dnl   GOBJECT_INTROSPECTION_CHECK([minimum-g-i-version])
-
-AC_DEFUN([GOBJECT_INTROSPECTION_CHECK],
-[
-  _GOBJECT_INTROSPECTION_CHECK_INTERNAL([$1])
-])
-
-dnl Usage:
-dnl   GOBJECT_INTROSPECTION_REQUIRE([minimum-g-i-version])
-
-
-AC_DEFUN([GOBJECT_INTROSPECTION_REQUIRE],
-[
-  _GOBJECT_INTROSPECTION_CHECK_INTERNAL([$1], [require])
-])
